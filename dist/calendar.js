define("#calendar/0.8.0/model",["$","#base/1.0.0/base","#class/1.0.0/class","#events/1.0.0/events","#moment/1.6.2/moment"],function(e,t,n){function l(e){e=(e||0).toString().toLowerCase();if(r.isNumeric(e))return e=parseInt(e),e;for(var t=0;t<f.length;t++)if(f[t].indexOf(e)===0){e=t;break}return e}function c(e){var t=[],n;for(i=0;i<a.length;i++)n=i==e,t.push({value:i,label:a[i],current:n});n={value:e,label:a[e]};var r=[];for(var i=0;i<t.length/3;i++)r.push(t.slice(i*3,i*3+3));return{current:n,items:r}}function h(e){var t=[{value:e-10,label:". . .",role:"previous-10-year",current:!1}];for(var n=e-6;n<e+4;n++)t.push({value:n,label:n,role:"year",current:!1});t[7]={value:e,label:e,role:"year",current:!0},t.push({value:e+10,label:". . .",role:"next-10-year",current:!1});var r=[];for(n=0;n<t.length/3;n++)r.push(t.slice(n*3,n*3+3));return{current:e,items:r}}function d(e){e=l(e);var t=[];for(var n=e;n<7;n++)t.push({label:p[n],value:n});for(n=0;n<e;n++)t.push({label:p[n],value:n});return{startDay:e,items:t}}function v(e,t,n){var r=[],i,s,u;t=l(t);var a=function(e,t){o&&(t+=" "+o(e)),r.push({datetime:e.format("YYYY-MM-DD"),date:e.date(),day:e.day(),className:t,available:g(e,n)})},f=e.clone().date(1),c=f.clone().add("months",-1),h=f.clone().add("months",1);i=f.day()-t,i<0&&(i+=7);if(i!=0){u=c.daysInMonth();for(v=i-1;v>=0;v--)s=c.date(u-v),a(s,"previous-month")}var p=e.format("YYYY-MM-DD");u=f.daysInMonth();for(v=1;v<=u;v++)s=f.date(v),s.format("YYYY-MM-DD")===p?a(s,"focused-element"):a(s,"");i=35-r.length;if(i!=0){i<0&&(i+=7);for(v=1;v<=i;v++)s=h.date(v),a(s,"next-month")}var d=[];for(var v=0;v<r.length/7;v++)d.push(r.slice(v*7,v*7+7));var m={date:e.date(),day:e.day()};return{focus:m,items:d}}function m(e){var t=s(e);return{hour:t.hours(),minute:t.minutes()}}function g(e,t){if(t==null)return!0;if(r.isArray(t)){var n=t[0],i=t[1],o=!0;return n&&(o=o&&e>=s(n)),i&&(o=o&&e<=s(i)),o}return r.isFunction(t)?t(e):!0}var r=e("$"),i=e("#base/1.0.0/base"),s=e("#moment/1.6.2/moment"),o,u=i.extend({attrs:{year:{setter:function(e){return h(e)}},month:{setter:function(e){return c(e)}},day:{setter:function(e){return d(this._startDay)}},date:{setter:function(e){return v(e,this._startDay,this.range)}},time:{setter:function(e){return m(e)}},mode:{setter:function(e){var t={date:!1,month:!1,year:!1};return t[e]=!0,t.time=this._showTime,t}},message:null},initialize:function(e){this._startDay=e.startDay,this._activeTime=e.focus.clone(),o=e.dateCustomize,this.range=e.range,this._showTime=e.showTime;var t=e.message||{};t.today="Today",this.set("message",t),this.set("mode","date"),this.renderData()},renderData:function(){this.set("year",this._activeTime.year()),this.set("month",this._activeTime.month()),this.set("date",this._activeTime.clone()),this.set("day"),this.set("time")},changeTime:function(e,t){this._activeTime.add(e,t),this.renderData()},changeStartDay:function(e){this._startDay=e,this.renderData()},changeMode:function(e,t){t||(t={}),"month"in t&&this._activeTime.month(t.month),t.year&&this._activeTime.year(t.year),this.set("mode",e),this.renderData()},selectDate:function(e){return e&&(this._activeTime=s(e),this.renderData()),this._activeTime.clone()},isInRange:function(e){return g(e,this.range)},toJSON:function(){var e={},t=this.attrs;for(var n in t)e[n]=this.get(n);return e},range:null,_activeTime:null,_startDay:0,_showTime:!1}),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],p=["Su","Mo","Tu","We","Th","Fr","Sa"];n.exports=u}),define("#calendar/0.8.0/calendar",["./model","$","#moment/1.6.2/moment","#overlay/0.9.9/overlay","#position/1.0.0/position","#iframe-shim/1.0.0/iframe-shim","#widget/1.0.0/widget","#base/1.0.0/base","#class/1.0.0/class","#events/1.0.0/events","#widget/1.0.0/templatable","#handlebars/1.0.0/handlebars"],function(e,t,n){var r=e("$"),i=e("#moment/1.6.2/moment"),s=e("#overlay/0.9.9/overlay"),o=e("#widget/1.0.0/templatable"),u='<div class="ui-calendar"><ul class="ui-calendar-navigation" data-role="navigation-container"><li class="ui-calendar-previous-year" data-role="prev-year">&lt;&lt;</li><li class="ui-calendar-previous-month" data-role="prev-month">&lt;</li><li class="ui-calendar-month-year" data-role="month-year-container"><span class="month" data-role="mode-month" data-value="{{month.current.value}}">{{_ month.current.label}}</span><span class="year" data-role="mode-year">{{year.current}}</span></li><li class="ui-calendar-next-month" data-role="next-month">&gt;</li><li class="ui-calendar-next-year" data-role="next-year">&gt;&gt;</li></ul><ul class="ui-calendar-control" data-role="pannel-container">{{#if mode.date}}{{#each day.items}}<li class="ui-calendar-day ui-calendar-day-{{value}}" data-role="day" data-value="{{value}}">{{_ label}}</li>{{/each}}{{/if}}</ul><div class="ui-calendar-data-container" data-role="data-container">{{#if mode.date}}{{#each date.items}}<ul class="ui-calendar-date-column">{{#each this}}<li class="ui-calendar-day-{{day}} {{className}}{{#unless available}}disabled-date{{/unless}}"data-role="date" data-datetime="{{datetime}}">{{date}}</li>{{/each}}</ul>{{/each}}{{/if}}{{#if mode.month}}{{#each month.items}}<ul class="ui-calendar-month-column">{{#each this}}<li {{#if current}}class="focused-element"{{/if}} data-role="month" data-value="{{value}}">{{_ label}}</li>{{/each}}</ul>{{/each}}{{/if}}{{#if mode.year}}{{#each year.items}}<ul class="ui-calendar-year-column">{{#each this}}<li {{#if current}}class="focused-element"{{/if}} data-role="{{role}}" data-value="{{value}}">{{_ label}}</li>{{/each}}</ul>{{/each}}{{/if}}</div><ul class="ui-calendar-footer" data-role="time-container"><li class="ui-calendar-today" data-role="today">{{_ message.today}}</li>{{#if mode.time}}<li class="ui-calendar-time" colspan="2" data-role="time"><span class="ui-calendar-hour">{{time.hour}}</span> : {{time.minute}}</li>{{/if}}</ul></div>',a=e("./model"),f={trigger:null,triggerType:"click",format:"YYYY-MM-DD",align:{getter:function(){var e=this.get("trigger");return e?{selfXY:[0,0],baseElement:e,baseXY:[0,r(e).height()+10]}:{selfXY:[0,0],baseXY:[0,0]}}},startDay:"Sun",showTime:!1,lang:null,focus:{value:"",getter:function(e){return i(e?e:undefined)}},range:null,template:u,model:{getter:function(){if(!this.hasOwnProperty("model")){var e={lang:this.get("lang"),focus:this.get("focus"),range:this.get("range"),showTime:this.get("showTime"),startDay:this.get("startDay")};this.model=new a(e)}return this.model}}},l=s.extend({Implements:[o],attrs:f,events:{"click [data-role=mode-year]":"_changeMode","click [data-role=prev-year]":"prevYear","click [data-role=next-year]":"nextYear","click [data-role=mode-month]":"_changeMode","click [data-role=prev-month]":"prevMonth","click [data-role=next-month]":"nextMonth","click [data-role=previous-10-year]":"_selectYear","click [data-role=next-10-year]":"_selectYear","click [data-role=year]":"_selectYear","click [data-role=month]":"_selectMonth","click [data-role=day]":"_selectDay","click [data-role=date]":"_selectDate","click [data-role=today]":"_selectToday"},setup:function(){var e=this,t=r(this.get("trigger"));t.on(this.get("triggerType"),function(){e.render().show()}),t.on("keydown",function(t){e._keyControl(t)}),t.on("blur",function(){e.hide()}),e.element.on("mousedown",function(e){if(r.browser.msie&&parseInt(r.browser.version)<9){var n=t[0];n.onbeforedeactivate=function(){window.event.returnValue=!1,n.onbeforedeactivate=null}}e.preventDefault()});var n=this.model,i={"change:year change:month":"[data-role=month-year-container]","change:day":"[data-role=pannel-container]","change:date":"[data-role=data-container]","change:time":"[data-role=time-container]","change:mode":["[data-role=data-container]","[data-role=pannel-container]"]};r.each(i,function(t,i){n.on(t,function(){r.isArray(i)||(i=[i]),r.each(i,function(t,n){e.renderPartial(n)})})}),e.get("showTime")&&setInterval(function(){n.set("time")},1e3)},range:function(e){this.model.range=e,this.model.renderData()},prevYear:function(){return this.model.changeTime("years",-1),this},nextYear:function(){return this.model.changeTime("years",1),this},prevMonth:function(){return this.model.changeTime("months",-1),this},nextMonth:function(){return this.model.changeTime("months",1),this},_selectYear:function(e){var t=r(e.target);t.data("role")==="year"?this.model.changeMode("date",{year:t.data("value")}):this.model.changeMode("year",{year:t.data("value")})},_selectMonth:function(e){var t=r(e.target);this.model.changeMode("date",{month:t.data("value")})},_selectDay:function(e){var t=r(e.target);this.model.changeStartDay(t.data("value"))},_selectDate:function(e){var t=r(e.target),n=this.model.selectDate(t.data("datetime"));this._fillDate(n)},_selectToday:function(){var e=i();this.model.selectDate(e)},_changeMode:function(e){var t=r(e.target).data("role").substring(5);this.model.changeMode(t)},_keyControl:function(e){e.preventDefault();var t={68:"date",77:"month",89:"year"};if(e.keyCode in t)return this.model.changeMode(t[e.keyCode]),!1;var n={13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",72:"left",76:"right",74:"down",75:"up"};if(!(e.keyCode in n))return;var r=n[e.keyCode],i=this.model.get("mode");e.shiftKey&&r==="down"?this.nextYear():e.shiftKey&&r==="up"?this.prevYear():e.shiftKey&&r==="right"?this.nextMonth():e.shiftKey&&r==="left"?this.prevMonth():r==="esc"?this.hide():i.date?this._keyControlDate(r):i.month?this._keyControlMonth(r):i.year&&this._keyControlYear(r)},_keyControlDate:function(e){if(e==="enter"){var t=this.model.selectDate();this._fillDate(t);return}var n={right:1,left:-1,up:-7,down:7};this.model.changeTime("days",n[e])},_keyControlMonth:function(e){if(e==="enter"){var t=this.model.selectDate();this.model.changeMode("date",{month:t.month()});return}var n={right:1,left:-1,up:-3,down:3};this.model.changeTime("months",n[e])},_keyControlYear:function(e){if(e==="enter"){var t=this.model.selectDate();this.model.changeMode("date",{year:t.year()});return}var n={right:1,left:-1,up:-3,down:3};this.model.changeTime("years",n[e])},_fillDate:function(e){if(!this.model.isInRange(e))return this.trigger("select-disabled-date",e),this;this.trigger("select-date",e);var t=this.get("trigger");if(!t)return this;var n=r(t);if(typeof n[0].value=="undefined")return this;var i=e.format(this.get("format"));n.val(i)}});l.autoRender=function(e){e.trigger=e.element,e.element="",new l(e)},n.exports=l});